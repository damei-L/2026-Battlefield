金融领域知识 - 测试工程师视角

一、支付链路核心角色与测试关注点
核心角色：用户/商户、收单机构、清算机构、发卡行、结算
用户/商户：支付界面的用户体验、各种异常操作（重复点击、中断）。
收单机构：支付成功，商户侧是否即时、准确收到通知？
清算机构：它计算出的应收应付金额，是否与所有参与方的记录完全吻合？
发卡行：扣款是否经过正确授权？余额不足等异常处理是否合规？
结算：结算是否在清算完成后？结算金额是否与清算结果一致？

用户正常支付是否可以使用，支付过程中页面金额是否正确，金额是否可以篡改，重复支付验证，订单取消确认，扣款是否正确，是否可以退款，退款成功后退款金额是否原路返回，重复提交退款是否可以正常处理。


二、核心概念辨析（用自己的话重写）
支付 vs 清算 vs 结算
支付：我付钱给你这个动作和过程。
清算：第三方（如银联）在后台计算今天我一共该给你多少钱，你该给银行多少钱。是算账。
结算：算完账后，银行实际把钱划过去。是搬钱。
为什么必须每日对账？
就像小卖部每天关门后，老板必须核对收银机里的现金和销售记录是否一致，否则一笔错账可能永远找不到，漏洞会越来越大。金融系统涉及海量资金，对账是发现数据差错、防止资金损失的最后一道防火墙

前面先走支付流程，中间要进行每日核算，核算没有问题了，再进行结算，目的是为了防止中间有对不起来的数据



三、待解问题清单（未来一周逐步攻克）
1.  一个完整的“支付成功”状态，在链路中各系统间是如何一步步传递和同步的？
支付系统处理支付请求，支付成功后进行交易汇总核算，然后生成账单，和算没有问题后进行打款操作
2.  常见的支付测试用例有哪些？（如：中途断网、重复支付、余额不足）
用户正常支付是否可以使用，支付过程中页面金额是否正确，金额是否可以篡改，重复支付验证，订单取消确认，扣款是否正确，是否可以退款，退款成功后退款金额是否原路返回，重复提交退款是否可以正常处理，断网时是否可以正常支付，余额不足时是否有相应的校验。



角色	它是什么？（简单理解）	测试工程师最该关心什么？（风险点）
用户/商户：付款方/收款方；各种前端交互操作及异常处理（下单（重复下单，撤销下单）、退款（全部退款、部分退款、部分退款后再申请全部退款，取消退款，退款时优惠券如何处理）、关单（关闭订单，取消关闭）、充值（余额不足，重复充值相同金额，撤销充值）、提现（部分提现、提现金额不足，撤销提现）、转账（转账金额不足，重复转账，撤销转账））收单、断网、切换网络、断电、信号差、超时、频繁操作、高并发、查询下载。
收单机构	帮商户收钱的“前台”。	交易状态同步：支付成功后，通知是否及时、准确到达商户，用户异常操作后是否可以正确处理，显示是否正确。金额是否计算准确。
清算机构	后台“算总账”的会计。	数据一致性：它算出的账，和所有银行、支付机构的记录能对上吗，权限：是否有权清算，清算的数据涵盖面是否全面。
发卡行	用户银行卡所在的银行。	资金安全：扣款授权是否合规，余额不足等异常场景处理是否正确，卡号是否有效。
结算	最后“搬钱”的动作。	时序与准确性：是否在清算完成后才执行，金额是否一分不差，结算成功是否收到确认信息，结算成功后是否生成记录可查，余额是否充足。


四、深入：支付对账
为什么对账系统像公司的“财务审计”？
1.核心目标相似：确保财务准确性
2. 功能重叠：差错发现与纠正
3. 风险防控：预防损失与合规
4. 自动化与效率提升
5. 支撑决策与透明度
对账系统本质上是 “财务审计的日常化、自动化延伸”。它通过技术手段将审计的核心目标——防错、纠偏、控风险——融入日常运营，成为企业资金管理的“第一道防线”。尤其在数字化时代，对账系统不仅是财务工具，更是企业风控能力和精细化运营水平的体现。

如果“支付成功记录”有10000笔，但“银行实际扣款记录”只有9999笔，可能是什么环节出了问题？（列出1-2种可能）
可能原因1：支付渠道的异步通知丢失（最常见）
可能原因2：内部系统间数据同步延迟或错误
这类问题的根源极少是银行多扣了钱，而大多是“交易成功”这一状态信息在从银行传递到商户内部系统的链路上出现了丢失或阻塞。

从测试角度，你会设计哪些用例来验证对账系统的准确性？（至少列出2条）
测试用例1：验证系统能准确识别并报告“单边账”差异
测试用例2：验证系统能正确处理“金额不一致”的复杂场景
